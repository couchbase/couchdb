SET(ESPRIMA_FILE ${CMAKE_CURRENT_SOURCE_DIR}/esprima.js)
SET(UNUSED_CONTEXT_FILE ${CMAKE_CURRENT_SOURCE_DIR}/unused/context.js)
SET(UNUSED_INDEX_FILE ${CMAKE_CURRENT_SOURCE_DIR}/unused/index.js)
SET(IS_DOC_USED_FILE ${CMAKE_CURRENT_SOURCE_DIR}/is_doc_used.js)
SET(BUILTIN_JS_FILE ${CMAKE_CURRENT_SOURCE_DIR}/builtin.js)

TRY_RUN(EMBED_DATA_EXITCODE EMBED_DATA_COMPILED
    ${CMAKE_CURRENT_BINARY_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/embed_data.c
    RUN_OUTPUT_VARIABLE JSFUNCTION_CONTENTS
    ARGS ${ESPRIMA_FILE} ${UNUSED_CONTEXT_FILE} ${UNUSED_INDEX_FILE}
         ${IS_DOC_USED_FILE} ${BUILTIN_JS_FILE})

STRING(REPLACE "\r" "\n" JSFUNCTION_CONTENTS "${JSFUNCTION_CONTENTS}")
FILE(WRITE ${CMAKE_CURRENT_BINARY_DIR}/jsfunctions_data.cc "${JSFUNCTION_CONTENTS}")
